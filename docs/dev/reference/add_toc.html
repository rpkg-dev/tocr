<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="DESCRIPTION Blabla..."><title>Add a table of contents (TOC) to an (R) Markdown document — add_toc • tocr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link rel="stylesheet" href="../deps/all.min.css"><link rel="stylesheet" href="../deps/v4-shims.min.css"><script src="../deps/bootstrap-toc.min.js"></script><script src="../deps/headroom.min.js"></script><script src="../deps/jQuery.headroom.min.js"></script><script src="../deps/clipboard.min.js"></script><script src="../deps/fuse.js"></script><script src="../deps/autocomplete.jquery.min.js"></script><script src="../deps/mark.min.js"></script><script src="../deps/MathJax.js"></script><script src="../deps/TeX-AMS-MML_HTMLorMML.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a table of contents (TOC) to an (R) Markdown document — add_toc"><meta property="og:description" content="DESCRIPTION Blabla..."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@2BSalim"><meta name="twitter:site" content="@2BSalim"><meta name="robots" content="noindex"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script src="https://rpkg.dev/counter-dev.js" data-id="4c4963fe-9fcf-4d81-95bb-2135e114b85b" data-utcoffset="1"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tocr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/tocr.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://gitlab.com/salim_b/r/pkgs/tocr/" aria-label="gitlab">
    <span class="fab fa fab fa-gitlab fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Add a table of contents (TOC) to an (R) Markdown document</h1>
      <small class="dont-index">Source: <a href="https://gitlab.com/salim_b/r/pkgs/tocr/blob/HEAD/R/tocr.gen.R" class="external-link"><code>R/tocr.gen.R</code></a></small>
      <div class="d-none name"><code>add_toc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>DESCRIPTION Blabla...</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_toc</span><span class="op">(</span></span>
<span>  <span class="va">md</span>,</span>
<span>  min_tier <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  max_tier <span class="op">=</span> <span class="fl">6L</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"above"</span>,</span>
<span>  md_flavor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"github"</span>, <span class="st">"gitlab"</span><span class="op">)</span>,</span>
<span>  add_title <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Table of contents"</span>,</span>
<span>  title_tier <span class="op">=</span> <span class="va">min_tier</span>,</span>
<span>  add_backlinks <span class="op">=</span> <span class="va">add_title</span>,</span>
<span>  backlink_strings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"↑"</span>, <span class="st">"↓"</span><span class="op">)</span>,</span>
<span>  backlink_position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"before"</span>, <span class="st">"after"</span><span class="op">)</span>,</span>
<span>  listing_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"*"</span>, <span class="st">"ordered"</span>, <span class="st">"indented"</span><span class="op">)</span>,</span>
<span>  toc_id <span class="op">=</span> <span class="st">"toc"</span>,</span>
<span>  old_toc_id <span class="op">=</span> <span class="va">toc_id</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>md</dt>
<dd><p>(R) Markdown document to be processed as a single file path, a single URL or a character vector (one string per line).</p></dd>


<dt>min_tier</dt>
<dd><p>Minimum tier of headers (<code>&lt;h1&gt;</code> – <code>&lt;h6&gt;</code>) to include in the TOC. Integer between <code>1</code> and <code>6</code>. <code>min_tier = 2</code> for example means to create TOC entries for all <code>&lt;h2&gt;</code> and below headers.</p></dd>


<dt>max_tier</dt>
<dd><p>Maximum tier of headers (<code>&lt;h1&gt;</code> – <code>&lt;h6&gt;</code>) to include in the TOC. Integer between <code>1</code> and <code>6</code>. <code>max_tier = 5</code> for example means to create TOC entries for all headers down to <code>&lt;h5&gt;</code>. <code>max_tier</code> must be &gt;= <code>min_tier</code>.</p></dd>


<dt>position</dt>
<dd><p>Position in the Markdown document at which to add the TOC. Possible values include:</p><ul><li><p><code>"top"</code>: The very beginning of the document, i.e. the first line.</p></li>
<li><p><code>"bottom"</code>: The very end of the document, i.e. the last line.</p></li>
<li><p><code>"above"</code>: Above the lines between the uppermost header of tier &lt;= <code>min_tier</code> and the next header above (if any).</p></li>
<li><p><code>"below"</code>: Below the lines between the uppermost header of tier &lt;= <code>min_tier</code> and the next header above (if any), i.e. right above the uppermost header of tier &lt;= <code>min_tier</code>.</p></li>
<li><p><code>"none"</code>: Only remove a possibly existing TOC.</p></li>
<li><p>A line number, given as a positive integer.</p></li>
</ul></dd>


<dt>md_flavor</dt>
<dd><p>Markdown flavor. Possible values include:</p><ul><li><p><code>"github"</code>:</p></li>
<li><p><code>"gitlab"</code>:</p></li>
</ul></dd>


<dt>add_title</dt>
<dd><p>Include a TOC title? Logical. Note that no backlinks are added at all if <code>add_title = FALSE</code> and no header line are found above <code>position</code>, regardless of <code>add_backlinks = TRUE</code>.</p></dd>


<dt>title</dt>
<dd><p>Title of the TOC. A character scalar.</p></dd>


<dt>title_tier</dt>
<dd><p>Tier/formatting of TOC title. Possible values include:</p><ul><li><p>An integer between <code>1L</code> and <code>6L</code> representing the <code>&lt;h1&gt;</code> – <code>&lt;h6&gt;</code> tier.</p></li>
<li><p><code>"regular"</code>: Simple unformatted non-header text.</p></li>
<li><p><code>"bold"</code>: Bold (<code>&lt;strong&gt;</code>) non-header text.</p></li>
<li><p><code>"italic"</code>: Italic (<code>&lt;em&gt;</code>) non-header text.</p></li>
</ul></dd>


<dt>add_backlinks</dt>
<dd><p>Add a link back to the TOC to each Markdown header. A logical scalar. Note that if <code>add_backlinks = TRUE</code> and <code>add_title = FALSE</code>, as a fallback the backlinks point to the next header line above <code>position</code> (if any found). This will also be the case if <code>md_flavor = "gitlab"</code> and <code>title_tier</code> is set to a non-header value (<code>"regular"</code>, <code>"bold"</code> or <code>"italic"</code>) because GitLab currently ignores manually set HTML <code>&lt;id&gt;</code> attributes.</p></dd>


<dt>backlink_strings</dt>
<dd><p>String(s) to use as link text back to the TOC. A character vector of length 1 or 2. If two strings are provided, the first one will be used for backlinks below <code>position</code>, the second one for backlinks above <code>position</code>. Note that at least Unicode 7.0 support is required for the default symbols <code>\U1F805</code> and <code>\U1F807</code> to be correctly displayed.</p></dd>


<dt>backlink_position</dt>
<dd><p>Position of the backlinks. Possible values include:</p><ul><li><p><code>"before"</code>: Before the actual header text.</p></li>
<li><p><code>"after"</code>: After the actual header text.</p></li>
</ul></dd>


<dt>listing_style</dt>
<dd><p>Format to use for listing the TOC entries. Possible values include:</p><ul><li><p><code>"-"</code>: Create an unordered list using a hyphen as listing symbol.</p></li>
<li><p><code>"*"</code>: Create an unordered list using an asterisk as listing symbol.</p></li>
<li><p><code>"ordered"</code>: Create an ordered list using <code>1</code>, <code>2</code>, <code>3</code>, ... as listing symbols.</p></li>
<li><p><code>"indented"</code>: Use non-breaking spaces (<code>&amp;nbsp;</code>) to create visual indentation. Useful if the headers are already numbered.</p></li>
</ul></dd>


<dt>toc_id</dt>
<dd><p>HTML <code>&lt;id&gt;</code> attribute of the TOC title if <code>title_tier</code> is set to a non-header value (<code>"regular"</code>, <code>"bold"</code> or <code>"italic"</code>). A character scalar.</p></dd>


<dt>old_toc_id</dt>
<dd><p>HTML <code>&lt;id&gt;</code> attribute of the old TOC title (in order to have old backlinks with an ID other than <code>toc_id</code> removed). A character scalar.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The processed Markdown document as a character vector (one string per line).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function tries to adhere to the <a href="http://commonmark.org/" class="external-link">CommonMark specification</a>, i.e. to interpret the Markdown syntax the same way as the <a href="https://github.com/jgm/commonmark.js" class="external-link">commonmark.js</a> reference implementation under &lt;try.commonmark.org&gt; does.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">md</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/ropensci/pdftools/"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"e7248d9956c7e73968628fa3a8ed37f0a8c23b37/README.md"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">md</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">tocr</span><span class="fu">::</span><span class="fu">add_toc</span><span class="op">(</span>position <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">pal</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pal/man/cat_lines.html" class="external-link">cat_lines</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # pdftools</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![Project Status: Active – The project has reached a stable, usable state and is being actively developed.](http://www.repostatus.org/badges/latest/active.svg)](http://www.repostatus.org/#active)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![Build Status](https://travis-ci.org/ropensci/pdftools.svg?branch=master)](https://travis-ci.org/ropensci/pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/ropensci/pdftools?branch=master&amp;svg=true)](https://ci.appveyor.com/project/jeroen/pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![Coverage Status](https://codecov.io/github/ropensci/pdftools/coverage.svg?branch=master)](https://codecov.io/github/ropensci/pdftools?branch=master)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/pdftools)](http://cran.r-project.org/package=pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![CRAN RStudio mirror downloads](http://cranlogs.r-pkg.org/badges/pdftools)](http://cran.r-project.org/web/packages/pdftools/index.html)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;!-- TOC BEGIN -- leave this comment untouched to allow auto update --&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Table of contents</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - [Introduction](#-introduction)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - [Installation](#-installation)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - [Building from source](#-building-from-source)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - [Getting started](#-getting-started)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - [Bonus feature: rendering pdf](#-bonus-feature-rendering-pdf)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - [Limitations](#-limitations)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;!-- TOC END -- leave this comment untouched to allow auto update --&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Introduction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scientific articles are typically locked away in PDF format, a format designed primarily for printing but not so great for searching or indexing. The new pdftools package allows for extracting text and metadata from pdf files in R. From the extracted plain-text one could find articles discussing a particular drug or species name, without having to rely on publishers providing metadata, or pay-walled search engines.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The pdftools slightly overlaps with the Rpoppler package by Kurt Hornik. The main motivation behind developing pdftools was that Rpoppler depends on glib, which does not work well on Mac and Windows. The pdftools package uses the poppler c++ interface together with Rcpp, which results in a lighter and more portable implementation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Installation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> On Windows and Mac the binary packages can be installed directly from CRAN:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> install.packages("pdftools")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Installation on Linux requires the poppler development library. On Debian/Ubuntu:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sudo apt-get install libpoppler-cpp-dev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> If you want to install the package from source on Mac OS-X you need brew:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> brew install poppler</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> On Fedora:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sudo yum install poppler-cpp-devel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### [↑](#table-of-contents) Building from source</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> On CentOS the `libpoppler-cpp` library is not included with the system so we need to build from source. Note that recent versions of poppler require C++11 which is not available on CentOS, so we build a slightly older version of libpoppler.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```sh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Build dependencies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> yum install wget xz libjpeg-devel openjpeg2-devel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Download and extract</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wget https://poppler.freedesktop.org/poppler-0.47.0.tar.xz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tar -Jxvf poppler-0.47.0.tar.xz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cd poppler-0.47.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Build and install</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ./configure</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> make</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sudo make install</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> By default libraries get installed in `/usr/local/lib` and `/usr/local/include`. On CentOS this is not a default search path so we need to set `PKG_CONFIG_PATH` and  `LD_LIBRARY_PATH` to point R to the right directory:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```sh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> export LD_LIBRARY_PATH="/usr/local/lib"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> export PKG_CONFIG_PATH="/usr/local/lib/pkgconfig"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> We can then start R and install `pdftools`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Getting started</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The `?pdftools` manual page shows a brief overview of the main utilities. The most important function is `pdf_text` which returns a character vector of length equal to the number of pages in the pdf. Each string in the vector contains a plain text version of the text on that page.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> library(pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> download.file("http://arxiv.org/pdf/1403.2805.pdf", "1403.2805.pdf", mode = "wb")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> txt &lt;- pdf_text("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # first page text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[1])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # second page text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[2])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In addition, the package has some utilities to extract other data from the PDF file. The `pdf_toc` function shows the table of contents, i.e. the section headers which pdf readers usually display in a menu on the left. It looks pretty in JSON:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Table of contents</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toc &lt;- pdf_toc("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Show as JSON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> jsonlite::toJSON(toc, auto_unbox = TRUE, pretty = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Other functions provide information about fonts, attachments and metadata such as the author, creation date or tags.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Author, version, etc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> info &lt;- pdf_info("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Table with fonts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fonts &lt;- pdf_fonts("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Bonus feature: rendering pdf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A bonus feature on most platforms is rendering of PDF files to bitmap arrays. The poppler library provides all functionality to implement a complete PDF reader, including graphical display of the content. In R we can use `pdf_render_page` to render a page of the PDF into a bitmap, which can be stored as e.g. png or jpeg.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # renders pdf to bitmap array</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bitmap &lt;- pdf_render_page("1403.2805.pdf", page = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # save bitmap image</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> png::writePNG(bitmap, "page.png")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> jpeg::writeJPEG(bitmap, "page.jpeg")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> webp::write_webp(bitmap, "page.webp")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This feature is still experimental and currently does not work on Windows.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Limitations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data scientists are often interested in data from tables. Unfortunately the pdf format is pretty dumb and does not have notion of a table (unlike for example HTML). Tabular data in a pdf file is nothing more than strategically positioned lines and text, which makes it difficult to extract the raw data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> txt &lt;- pdf_text("http://arxiv.org/pdf/1406.4806.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # some tables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[18])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[19])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pdftools usually does a decent job in retaining the positioning of table elements when converting from pdf to text. But the output is still very dependent on the formatting of the original pdf table, which makes it very difficult to write a generic table extractor. But with a little creativity you might be able to parse the table data from the text output of a given paper.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![](http://ropensci.org/public_images/github_footer.png)](http://ropensci.org)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">md</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">tocr</span><span class="fu">::</span><span class="fu">add_toc</span><span class="op">(</span>listing_style <span class="op">=</span> <span class="st">"ordered"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">pal</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pal/man/cat_lines.html" class="external-link">cat_lines</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # pdftools</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;!-- TOC BEGIN -- leave this comment untouched to allow auto update --&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Table of contents</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1. [Introduction](#-introduction)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2. [Installation](#-installation)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1. [Building from source](#-building-from-source)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1. [Getting started](#-getting-started)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2. [Bonus feature: rendering pdf](#-bonus-feature-rendering-pdf)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3. [Limitations](#-limitations)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;!-- TOC END -- leave this comment untouched to allow auto update --&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![Project Status: Active – The project has reached a stable, usable state and is being actively developed.](http://www.repostatus.org/badges/latest/active.svg)](http://www.repostatus.org/#active)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![Build Status](https://travis-ci.org/ropensci/pdftools.svg?branch=master)](https://travis-ci.org/ropensci/pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/ropensci/pdftools?branch=master&amp;svg=true)](https://ci.appveyor.com/project/jeroen/pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![Coverage Status](https://codecov.io/github/ropensci/pdftools/coverage.svg?branch=master)](https://codecov.io/github/ropensci/pdftools?branch=master)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/pdftools)](http://cran.r-project.org/package=pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![CRAN RStudio mirror downloads](http://cranlogs.r-pkg.org/badges/pdftools)](http://cran.r-project.org/web/packages/pdftools/index.html)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Introduction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scientific articles are typically locked away in PDF format, a format designed primarily for printing but not so great for searching or indexing. The new pdftools package allows for extracting text and metadata from pdf files in R. From the extracted plain-text one could find articles discussing a particular drug or species name, without having to rely on publishers providing metadata, or pay-walled search engines.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The pdftools slightly overlaps with the Rpoppler package by Kurt Hornik. The main motivation behind developing pdftools was that Rpoppler depends on glib, which does not work well on Mac and Windows. The pdftools package uses the poppler c++ interface together with Rcpp, which results in a lighter and more portable implementation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Installation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> On Windows and Mac the binary packages can be installed directly from CRAN:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> install.packages("pdftools")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Installation on Linux requires the poppler development library. On Debian/Ubuntu:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sudo apt-get install libpoppler-cpp-dev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> If you want to install the package from source on Mac OS-X you need brew:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> brew install poppler</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> On Fedora:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sudo yum install poppler-cpp-devel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### [↑](#table-of-contents) Building from source</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> On CentOS the `libpoppler-cpp` library is not included with the system so we need to build from source. Note that recent versions of poppler require C++11 which is not available on CentOS, so we build a slightly older version of libpoppler.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```sh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Build dependencies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> yum install wget xz libjpeg-devel openjpeg2-devel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Download and extract</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wget https://poppler.freedesktop.org/poppler-0.47.0.tar.xz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tar -Jxvf poppler-0.47.0.tar.xz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cd poppler-0.47.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Build and install</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ./configure</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> make</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sudo make install</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> By default libraries get installed in `/usr/local/lib` and `/usr/local/include`. On CentOS this is not a default search path so we need to set `PKG_CONFIG_PATH` and  `LD_LIBRARY_PATH` to point R to the right directory:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```sh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> export LD_LIBRARY_PATH="/usr/local/lib"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> export PKG_CONFIG_PATH="/usr/local/lib/pkgconfig"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> We can then start R and install `pdftools`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Getting started</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The `?pdftools` manual page shows a brief overview of the main utilities. The most important function is `pdf_text` which returns a character vector of length equal to the number of pages in the pdf. Each string in the vector contains a plain text version of the text on that page.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> library(pdftools)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> download.file("http://arxiv.org/pdf/1403.2805.pdf", "1403.2805.pdf", mode = "wb")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> txt &lt;- pdf_text("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # first page text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[1])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # second page text</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[2])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In addition, the package has some utilities to extract other data from the PDF file. The `pdf_toc` function shows the table of contents, i.e. the section headers which pdf readers usually display in a menu on the left. It looks pretty in JSON:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Table of contents</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toc &lt;- pdf_toc("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Show as JSON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> jsonlite::toJSON(toc, auto_unbox = TRUE, pretty = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Other functions provide information about fonts, attachments and metadata such as the author, creation date or tags.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Author, version, etc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> info &lt;- pdf_info("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Table with fonts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fonts &lt;- pdf_fonts("1403.2805.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Bonus feature: rendering pdf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A bonus feature on most platforms is rendering of PDF files to bitmap arrays. The poppler library provides all functionality to implement a complete PDF reader, including graphical display of the content. In R we can use `pdf_render_page` to render a page of the PDF into a bitmap, which can be stored as e.g. png or jpeg.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # renders pdf to bitmap array</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bitmap &lt;- pdf_render_page("1403.2805.pdf", page = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # save bitmap image</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> png::writePNG(bitmap, "page.png")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> jpeg::writeJPEG(bitmap, "page.jpeg")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> webp::write_webp(bitmap, "page.webp")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This feature is still experimental and currently does not work on Windows.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## [↑](#table-of-contents) Limitations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data scientists are often interested in data from tables. Unfortunately the pdf format is pretty dumb and does not have notion of a table (unlike for example HTML). Tabular data in a pdf file is nothing more than strategically positioned lines and text, which makes it difficult to extract the raw data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> txt &lt;- pdf_text("http://arxiv.org/pdf/1406.4806.pdf")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # some tables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[18])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat(txt[19])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pdftools usually does a decent job in retaining the positioning of table elements when converting from pdf to text. But the output is still very dependent on the formatting of the original pdf table, which makes it very difficult to write a generic table extractor. But with a little creativity you might be able to parse the table data from the text output of a given paper.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [![](http://ropensci.org/public_images/github_footer.png)](http://ropensci.org)</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Salim Brüggemann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

